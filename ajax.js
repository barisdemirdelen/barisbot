// stores the reference to the XMLHttpRequest objectsent = 1;var xmlHttp = createXmlHttpRequestObject();// retrieves the XMLHttpRequest objectfunction createXmlHttpRequestObject() {    // will store the reference to the XMLHttpRequest object    var xmlHttp;    // modern browsers    if (window.XMLHttpRequest) {        try {            xmlHttp = new XMLHttpRequest();        } catch (e) {            xmlHttp = false;        }    } else { // if running old Internet Explorer        try {            xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");        } catch (e) {            xmlHttp = false;        }    }    // return the created object or display an error message    if (!xmlHttp) {        alert("Error creating the XMLHttpRequest object.");        return null;    } else {        return xmlHttp;    }}// make asynchronous HTTP request using the XMLHttpRequest object function process() {    // proceed only if the xmlHttp object isn't busy    var msg = document.getElementById("message").value;    document.getElementById("message").value = "";    var message;    if (msg != "" && msg != null) {        document.getElementById("divMessage").innerHTML = "Ben: " + msg + "<br />" + document.getElementById("divMessage").innerHTML;        if (xmlHttp.readyState == 4 || xmlHttp.readyState == 0) {            // retrieve the name typed by the user on the form            message = encodeURIComponent(msg);            xmlHttp.open("GET", "/bot/ajax.php?sent=" + sent + "&message=" + message, true);            // define the method to handle server responses            xmlHttp.onreadystatechange = function () {                var response;                var sent;                var received;                if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {                    response = xmlHttp.responseText;                    sent = response.substring(0, response.indexOf(" "));                    received = response.substring(response.indexOf(" ") + 1);                    document.getElementById("divMessage").innerHTML = "Barış: " + received + "<br />" + document.getElementById("divMessage").innerHTML;                }            }            // make the server request            xmlHttp.send();        } else {            setTimeout('process()', 1000);        }    }}